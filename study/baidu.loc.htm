<!doctype html>
<html>
<head>
<meta charset="gbk">
<title>location</title>
<script src="http://192.168.1.228/dgfzg/template/default/js/jquery-1.9.1.min.js"></script>
<script src="http://api.map.baidu.com/api?ak=3GGtGlCtbAGa1GYK70XFX2Rb&v=2.0&services=false"></script>
<style type="text/css">
#allmap{height:720px;width:640px; float:right; }
</style>
</head>

<body>

<div id="allmap"></div>

<div>
<p id="allpos"></p>
<p id="alladdr"></p>
</div>

<script>
var geoc, map; // console.log(adds);
$(function(){
	geoc = new BMap.Geocoder(); // 定位对象
	var geolocation = new BMap.Geolocation();
	geolocation.getCurrentPosition(function(res){
		if(this.getStatus() == BMAP_STATUS_SUCCESS){
			//showMap("allmap", res);
			//setLoc(res.point);
			$("#allpos").html("经纬度: "+res.point.lng+','+res.point.lat);
		}else {
			alert('无法定位到您的当前位置！');
		}
	}, {enableHighAccuracy:true});
});
//获取地理位置
function setLoc(point){
	geoc.getLocation(point, function(res){
		var adds = res.addressComponents;
		var addr = adds.province + adds.city + adds.district + adds.street + adds.streetNumber;
		$("#alladdr").html("地址: "+addr);
	});
}
//显示地图
function showMap(id, res){
	map = new BMap.Map(id);
	map.centerAndZoom(res.point, 16);
	var mark = new BMap.Marker(res.point);
	map.addOverlay(mark);
}
</script>

</body>
</html>
